# Технический стек проекта

## Обзор архитектуры

Проект использует модульную архитектуру с разделением на независимые сервисы:
- **Frontend** (Next.js) - пользовательский интерфейс
- **PDF Service** (Node.js + Playwright) - рендеринг PDF
- **Core API** (опционально) - бизнес-логика генераторов

## Frontend: Next.js Stack

### Основные технологии
- **Next.js 15** с App Router - современный React фреймворк
- **React 18** - библиотека UI компонентов  
- **TypeScript 5+** - типизация и безопасность кода
- **SSR/ISR** - серверный рендеринг для SEO и производительности

### Стилизация и UI
- **Tailwind CSS** - utility-first CSS фреймворк
- **shadcn/ui** - готовые компоненты с доступностью- **Radix UI** - примитивы для сложных компонентов

### Валидация и формы  
- **Zod** - схема валидации TypeScript-first
- **React Hook Form** - производительные формы
- **@hookform/resolvers** - интеграция с валидаторами

### HTTP и состояние
- **TanStack Query** - кэширование и синхронизация данных
- **Axios** - HTTP клиент с перехватчиками

### Аргументы выбора Next.js:
- **SEO-ready** из коробки (важно для образовательного контента)
- **Производительность** благодаря SSR/ISR
- **Developer Experience** с hot reload и TypeScript
- **Экосистема** и community support

## PDF Service: Node.js + Playwright

### Основные технологии
- **Node.js 20+** - серверная платформа
- **Playwright** - автоматизация браузера для PDF
- **Chromium** - рендеринг движок- **Express/Fastify** - HTTP сервер
- **Handlebars/EJS** - шаблонизация HTML

### Преимущества Playwright для PDF:
- **Высокое качество** рендеринга (как в браузере)
- **CSS Grid/Flexbox** для сложных макетов  
- **Шрифты** и типографика работают идентично браузеру
- **Стабильность** и производительность

### Альтернативы и почему не выбрали:
- **Puppeteer** - менее стабильный, только Chrome
- **jsPDF** - ограниченные возможности верстки
- **PDFKit** - требует много low-level кода

## Хранилище и кэширование  

### База данных
- **PostgreSQL 15+** - основная БД для словарей и конфигураций
- **Prisma** - ORM с type safety (альт: Knex.js)

### Кэширование
- **Redis 7** - кэш сгенерированных PDF и сессии- **MinIO/S3** - файловое хранилище для PDF

### Почему PostgreSQL:
- **JSONB** для гибких конфигураций генераторов
- **Full-text search** для поиска по словарям
- **Надежность** и ACID транзакции
- **Масштабирование** read-replica

## Инфраструктура и DevOps

### Контейнеризация
- **Docker** - упаковка приложений
- **Docker Compose** - локальная разработка
- **Multi-stage builds** - оптимизация размера образов

### CI/CD  
- **GitHub Actions** - автоматизация deploy и тестов
- **Dependabot** - обновление зависимостей

### Мониторинг и логи
- **Prometheus + Grafana** - метрики (будущее)
- **Winston** - структурированное логирование- **Sentry** - отслеживание ошибок

### Развертывание (MVP)
- **VPS/Dedicated server** - один сервер для начала
- **Traefik/Nginx** - reverse proxy и SSL
- **Let's Encrypt** - бесплатные SSL сертификаты

## Инструменты разработки

### Code Quality
- **ESLint** - линтинг JavaScript/TypeScript
- **Prettier** - форматирование кода  
- **Husky** - pre-commit hooks
- **lint-staged** - линтинг только изменений

### Тестирование
- **Vitest** - unit тесты (быстрая альтернатива Jest)
- **Playwright Test** - E2E тестирование
- **Testing Library** - тестирование React компонентов

### Безопасность
- **Helmet** - HTTP заголовки безопасности
- **Rate limiting** - защита от спама
- **Input validation** - защита от инъекций

## Сравнение альтернатив

### Frontend: Next.js vs конкуренты

| Технология | Плюсы | Минусы | Вердикт |
|------------|-------|---------|---------|
| **Next.js** | SEO, SSR, ecosystem | Learning curve | ✅ **Выбран** |  
| Nuxt.js | Vue ecosystem, SSR | Меньше jobs | ❌ Команда знает React |
| SvelteKit | Производительность | Маленькая экосистема | ❌ Рискованно для продукта |
| Remix | Web standards | Новая технология | ❌ Меньше готовых решений |
### PDF Generation: Playwright vs конкуренты

| Технология | Качество | Производительность | Сложность | Вердикт |
|------------|----------|-------------------|-----------|---------|
| **Playwright** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ✅ **Выбран** |
| Puppeteer | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ❌ Менее стабильный |
| jsPDF | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐ | ❌ Лимиты верстки |
| PDFKit | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ❌ Много кода |
| wkhtmltopdf | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | ❌ Устаревший |

## Планы развития стека

### Ближайшие улучшения (3-6 месяцев)
- **Prisma** вместо сырого SQL
- **Redis Cluster** для масштабирования кэша  
- **Docker Swarm** или **K8s** для оркестрации
- **CDN** (CloudFlare) для статики

### Долгосрочные планы (6-12 месяцев)  
- **Микросервисы** для каждого типа генератора
- **GraphQL** для API между сервисами
- **Event-driven architecture** для асинхронности
- **Kubernetes** для продакшена

## Выводы

Стек выбран с учетом:
1. **Быстрый MVP** - знакомые технологии
2. **Качество PDF** - Playwright даёт лучший результат
3. **Масштабирование** - архитектура готова к росту
4. **Надежность** - проверенные решения в продакшене