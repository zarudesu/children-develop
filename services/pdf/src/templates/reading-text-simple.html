<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{title}}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Comfortaa:wght@300;400;700&display=swap');

        @font-face {
            font-family: 'Propisi';
            src: url('file:///app/src/fonts/Propisi.TTF') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: {{fontFamily fontFamily}};
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        .title {
            font-size: 18pt;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
            padding: 0 20px;
        }

        .exercise-text {
            font-size: {{fontSize fontSize}};
            line-height: 1.8;
            padding: 30px;
            border: 3px solid #333;
            margin: 15px;
            height: calc(100vh - 30px);
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
            word-break: break-all;
            hyphens: none;
            overflow-y: auto;
        }

        /* CSS-методы обрезания текста для техники чтения */

        /* Метод 1: overflow hidden - базовый метод */
        .bottom-cut-overflow {
            display: inline-block;
            height: 0.4em;
            overflow: hidden;
            vertical-align: baseline;
        }

        .top-cut-overflow {
            display: inline-block;
            height: 0.6em;
            overflow: hidden;
            line-height: 1em;
            margin-top: 0.4em;
            vertical-align: baseline;
        }

        /* Метод 2: clip-path - современный метод */
        .bottom-cut-clippath {
            display: inline-block;
            clip-path: polygon(0% 60%, 100% 60%, 100% 100%, 0% 100%);
            vertical-align: baseline;
        }

        .top-cut-clippath {
            display: inline-block;
            clip-path: polygon(0% 0%, 100% 0%, 100% 40%, 0% 40%);
            vertical-align: baseline;
        }

        /* Метод 3: scaleY - трансформация */
        .bottom-cut-scale {
            display: inline-block;
            transform: scaleY(0.4) translateY(60%);
            transform-origin: bottom;
            vertical-align: baseline;
        }

        .top-cut-scale {
            display: inline-block;
            transform: scaleY(0.6) translateY(-40%);
            transform-origin: top;
            vertical-align: baseline;
        }

        /* Метод 4: псевдоэлементы - через :before/:after */
        .bottom-cut-pseudo {
            position: relative;
            display: inline-block;
            vertical-align: baseline;
            overflow: hidden;
        }

        .bottom-cut-pseudo::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: white;
            z-index: 1;
        }

        .top-cut-pseudo {
            position: relative;
            display: inline-block;
            vertical-align: baseline;
        }

        .top-cut-pseudo:before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: white;
            z-index: 1;
        }

        /* Метод 5: CSS mask - маскирование */
        .bottom-cut-mask {
            display: inline-block;
            mask: linear-gradient(to bottom, transparent 0%, transparent 60%, black 60%, black 100%);
            -webkit-mask: linear-gradient(to bottom, transparent 0%, transparent 60%, black 60%, black 100%);
            vertical-align: baseline;
        }

        .top-cut-mask {
            display: inline-block;
            mask: linear-gradient(to bottom, black 0%, black 40%, transparent 40%, transparent 100%);
            -webkit-mask: linear-gradient(to bottom, black 0%, black 40%, transparent 40%, transparent 100%);
            vertical-align: baseline;
        }

        /* ОСНОВНОЙ МЕТОД - используется в продакшене */
        .bottom-cut {
            --cut-percentage: 60%; /* fallback */
            display: inline-block;
            clip-path: polygon(0% var(--cut-percentage), 100% var(--cut-percentage), 100% 100%, 0% 100%);
            vertical-align: baseline;
        }

        .top-cut {
            --cut-percentage: 40%; /* fallback */
            display: inline-block;
            clip-path: polygon(0% 0%, 100% 0%, 100% var(--cut-percentage), 0% var(--cut-percentage));
            vertical-align: baseline;
        }

        /* Стили для других трансформаций */
        .extra-letter {
            color: #888;
            font-weight: normal;
        }

        .mirror-text {
            transform: scaleX(-1);
            display: inline-block;
        }

        /* Специальное правило для слитного текста - добавляет возможность переноса после каждой буквы */
        .merged-text {
            word-break: break-all;
            overflow-wrap: anywhere;
            hyphens: none;
        }
    </style>
</head>
<body>
    {{#if title}}
    <div class="title">{{title}}</div>
    {{/if}}


    <div class="exercise-text">
        {{{transformedText}}}
    </div>


    {{#if originalText}}
    <div style="page-break-before: always;">
        <div class="title">Исходный текст</div>
        <div class="exercise-text">
            {{originalText}}
        </div>
    </div>
    {{/if}}
</body>
</html>